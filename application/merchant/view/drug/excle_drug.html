{extend name='public/modal'} 
{block name='content'}
<style type="text/css">
    .submit_btn {
        float: center;
    }
</style>

<form class="layui-form" method="post" action="">
    <div class="layui-form-item">
        <label class="layui-form-label">上传excel</label>
        <div class="layui-input-inline">
            <div class="layui-upload">
                <button type="button" name="myfile" class="layui-btn" id="myfile">
                    <i class="layui-icon"></i>上传文件</button>
            </div>
        </div>
    </div>

    <div class="layui-form-item" style="padding-left: 35%;">
        <div class="layui-input-inline">
            <button class="layui-btn" lay-submit lay-filter="formsub">立即提交</button>
            <button type="reset" class="layui-btn layui-btn-primary">重置</button>
        </div>
    </div>

</form>

{/block} 
{block name='js'}
<script type="text/javascript">
    $(function () {
        var options = {
            type: 'post', //post提交
            //url:'http://ask.tongzhuo100.com/server/****.php?='+Math.random(),   //url
            dataType: "json", //json格式
            data: {}, //如果需要提交附加参数，视情况添加
            clearForm: false, //成功提交后，清除所有表单元素的值
            resetForm: false, //成功提交后，重置所有表单元素的值
            cache: false,
            async: false, //同步返回
            success: function (data) {
                if (data.code == 0) {
                    layer.msg(data.msg);
                } else {
                    layer.msg(data.msg, {
                        icon: 1,
                        time: 500
                    }, function () {
                        $("#reset").click();
                        lotus_close();
                        parent.location.reload();
                    });
                }
                //服务器端返回处理逻辑
            },
            error: function (XmlHttpRequest, textStatus, errorThrown) {
                layer.msg('操作失败:服务器处理失败');
            }
        };
        layui.use('form', function () {
            var form = layui.form;
            $('#mainForm').ajaxForm(options).submit(function (data) {
                console.log("编辑完成", data)
            });
        });

    })
    // });
</script>


<!-- 点击上传文件按钮 -->
<script type="text/javascript">
    layui.use(['form','upload'],function(){

        var form=layui.form;
        var upload=layui.upload;

        upload.render({ //允许上传的文件后缀
            elem: '#myfile'
            ,url: "{:url('merchant/Drug/do_upload')}"
            ,accept: 'file' //普通文件
            ,exts: 'xls|excel|xlsx' //只允许上传压缩文件
            ,done: function(res){
                if(res.code==1){
                    layer.msg('上传成功,已解析数据',{icon:6});
                }else{
                    layer.msg('解析失败',{icon:5});
                }
            }
        });

        form.on('submit(formsub)',function(data){
            layer.msg('导入数据具体详情未协商确认,待确认后处理');
            return false;
        })
        
    })

</script>

{/block}